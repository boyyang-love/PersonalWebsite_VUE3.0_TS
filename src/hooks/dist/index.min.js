"use strict";exports.__esModule=!0;var index_ts_1=require("@/db/index.ts"),FileUp=function(){function t(t){this.state=t,this.__init__()}return t.prototype.__init__=function(){var n=this,t=localStorage.getItem("BG");index_ts_1.db.collection("usersBg").where({_id:t}).get().then(function(t){0!=t.data.length&&(n.state.bg=t.data[0].tempFileURL,n.state.id=t.data[0]._id,n.state.fileID=t.data[0].fileID)})},t.prototype.fileUpdate=function(t){var n=this;index_ts_1.app.uploadFile({cloudPath:"bg/"+t.name,filePath:t}).then(function(t){index_ts_1.app.getTempFileURL({fileList:[{fileID:t.fileID,maxAge:6e3}]}).then(function(t){n.state.bg=t.fileList[0].tempFileURL,index_ts_1.db.collection("usersBg").add({downloadUrl:t.fileList[0].download_url,fileID:t.fileList[0].fileID,fileid:t.fileList[0].fileid,tempFileURL:t.fileList[0].tempFileURL}).then(function(t){localStorage.setItem("BG",t.id)})})})},t}();exports.FileUp=FileUp;var Login=function(){function t(){}return t.prototype.singin=function(i,o){return new Promise(function(n,e){index_ts_1.db.collection("users").where({email:i}).get().then(function(t){0==t.data.length?n("不存在该用户,请注册"):index_ts_1.auth.signInWithEmailAndPassword(i,o).then(function(){n("登录成功")}).catch(function(){e("账号或密码错误")})})})},t.prototype.singup=function(i,o){return new Promise(function(n,e){index_ts_1.db.collection("users").where({email:i}).get().then(function(t){0==t.data.length?index_ts_1.auth.signUpWithEmailAndPassword(i,o).then(function(){index_ts_1.db.collection("users").add({name:"",age:"",gender:"",email:i,backgroundImage:"",phoneNumber:"",qqNumber:"",wechat:""}).then(function(){n("注册成功")})}).catch(function(){e("注册失败")}):n("该账号已经注册过")})})},t.prototype.signout=function(){return new Promise(function(n,e){index_ts_1.auth.signOut().then(function(t){n(t)}).catch(function(t){e(t)})})},t.prototype.isLogin=function(){return new Promise(function(e,t){index_ts_1.auth.getLoginState().then(function(t){var n;e(null===(n=t)||void 0===n?void 0:n.loginType)}).catch(function(){t("未登录")})})},t}();exports.Login=Login;var Getbackground=function(){function t(){}return t.prototype.getbg=function(){return new Promise(function(n,e){index_ts_1.db.collection("usersBg").get().then(function(t){t&&n(t)}).catch(function(t){e(t)})})},t.prototype.download=function(t){return new Promise(function(n,e){index_ts_1.app.downloadFile({fileID:t}).then(function(t){n(t)}).catch(function(t){e(t)})})},t}();exports.Getbackground=Getbackground;
//# sourceMappingURL=index.min.js.map
